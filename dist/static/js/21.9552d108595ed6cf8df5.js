webpackJsonp([21],{NJTp:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("3Xzz"),n=a("5QTb"),o=a("M2/U"),i=a("3fED"),s=(a("Mk6G"),a("3E4D")),l=a("Ch4/"),u=a("PI0u"),c=a("P9l9"),g={name:"myTagList",data:function(){return{navpath:[{name:"首页",path:window.location.origin+"/report/#/memberSummary",relocation:!0},{name:"会员管理",path:""},{name:"会员标签",path:""},{name:"我的标签库",path:"/myTagLib"},{name:"我的标签列表",path:""}],showTagDetail:!1,tagShortDetailId:"",fromFlag:"myTag",tagLibName:"myTag",tagSearch:"",tagTableData:[],currentPage:1,pageSize:20,total:0,currentGroupId:0}},methods:{changeRoute:function(t){this.$router.push(t)},handleShowTag:function(){this.showTagDetail=!0},handleHideTag:function(t){this.showTagDetail=!1},toManualTagLib:function(){this.changeRoute("/manualTagList")},toPlatformTagLib:function(){this.changeRoute("/platformTagList")},searchEnterFun:Object(u.a)(function(t){this.currentPage=1,this.getTagList()},500),clearSearch:function(){this.currentPage=1,this.getTagList()},handleSizeChange:function(t){this.pageSize=t,this.getTagList()},handleCurrentChange:function(t){this.currentPage=t,this.$route.fullPath.includes("?")&&this.$router.push(this.$route.path+"?tagLevelGroupId="+this.$route.query.tagLevelGroupId+"&currentPage="+t),this.getTagList()},getTagList:function(){var t=this,e={tagName:t.tagSearch,tagLevelGroupId:t.currentGroupId,pageNum:t.currentPage,pageSize:t.pageSize};Object(c.a)("/enterpriseMemberTag/pageList",e).then(function(e){var a=e.data;if(1==a.errorCode)return a.result.result&&a.result.result.length?(a.result.result.forEach(function(t,e){t.popVisible=!1}),t.tagTableData=a.result.result):(t.tagTableData=[],t.$message.error({duration:1e3,message:"未找到数据"})),void(t.total=a.result.totalCount);l.a.errorMsg(a)}).catch(function(e){t.$message.error({duration:1e3,message:e.message})})},addTemporary:function(t){this.tagShortDetailId=t,this.showTagDetail=!0,this.$refs.tagTemp.hideTagList()},cancelDelTag:function(t,e){e.popVisible=!1},toDelTag:function(t,e){var a=this;a.$confirm("确认要删除此标签吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.postToDelTag(t,e)}).catch(function(){})},postToDelTag:function(t,e){var a=this,r={enterpriseMemberTagId:e.enterpriseMemberTagId};Object(c.a)("/enterpriseMemberTag/del",r).then(function(e){var r=e.data;if(1==r.errorCode)return s.a.showmsg("删除成功","success"),a.tagTableData.splice(t,1),void a.$refs.tagTemp.getTagList();l.a.errorMsg(r)}).catch(function(t){a.$message.error({duration:1e3,message:t.message})})},showShortDetail:function(t){this.showTagDetail=!0,this.tagShortDetailId=t},updateTemp:function(){this.$refs.tagTemp.getTagList(),this.$refs.tagTemp.showTagList()},getUrlParams:function(){this.tagSearch=this.$route.query.searchName?this.$route.query.searchName:"",this.currentGroupId=this.$route.query.tagLevelGroupId?this.$route.query.tagLevelGroupId:0,this.currentPage=this.$route.query.currentPage?parseInt(this.$route.query.currentPage):1,this.getTagList()}},watch:{$route:{handler:function(t,e){this.getUrlParams()},deep:!0}},mounted:function(){this.getUrlParams()},components:{navCrumb:r.a,tagShortDetail:i.a,tagCategory:n.a,tagTemporary:o.a}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"myTagList-wrap common-wrap"},[a("nav-crumb",{attrs:{navpath:t.navpath}}),t._v(" "),a("div",{staticClass:"right-content"},[a("div",{staticClass:"right-box"},[a("div",{staticClass:"common-wrap__cateTags"},[a("tag-category",{attrs:{tagLibName:t.tagLibName}})],1),t._v(" "),a("div",{staticClass:"common-wrap__opt"},[a("el-input",{staticClass:"w-184",attrs:{placeholder:"搜索标签","prefix-icon":"el-icon-search",clearable:""},on:{clear:t.clearSearch},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;var a;a=e,t.searchEnterFun(a)}},model:{value:t.tagSearch,callback:function(e){t.tagSearch=e},expression:"tagSearch"}})],1),t._v(" "),a("div",{staticClass:"common-wrap__table m-t-20"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tagTableData,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:"标签名称","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"pointer name-hover",on:{click:function(a){t.addTemporary(e.row.tagId)}}},[t._v(t._s(e.row.tagName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"tagDescribe",label:"标签描述","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"是否实时"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(1==e.row.isActive?"实时":"非实时")+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"edit-btn el-button--text",attrs:{to:{path:"/myTagDetail",query:{tagId:e.row.tagId}}}},[t._v("详情")]),t._v(" "),a("el-button",{staticClass:"p-l-10",attrs:{type:"text",size:"small"},on:{click:function(a){t.addTemporary(e.row.tagId)}}},[t._v("添加至暂存架")]),t._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},on:{click:function(a){t.toDelTag(e.$index,e.row)}},slot:"reference"},[t._v("\n                删除\n              ")])]}}])})],1)],1),t._v(" "),0!=t.tagTableData.length?a("div",{staticClass:"block common-wrap__page text-right"},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":[10,20,30,40],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()])]),t._v(" "),a("vue-gic-footer"),t._v(" "),a("tagShortDetail",{attrs:{fromFlag:t.fromFlag,tagShortId:t.tagShortDetailId,showTagDetail:t.showTagDetail},on:{"update:tagShortId":function(e){t.tagShortDetailId=e},hideTag:t.handleHideTag,updateTemp:t.updateTemp}}),t._v(" "),a("tag-temporary",{ref:"tagTemp",on:{showShortDetail:t.showShortDetail}})],1)},staticRenderFns:[]};var p=a("VU/8")(g,h,!1,function(t){a("QaEG")},"data-v-5b924529",null);e.default=p.exports},QaEG:function(t,e){}});